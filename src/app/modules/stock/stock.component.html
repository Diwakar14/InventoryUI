<div class="context-menu">
  <div class="passive">
    <header class="page-header">
      <h2>Stock</h2>
    </header>
    <div class="route-search-box">
      <i class="bi bi-search"></i>
      <input
        type="search"
        autocomplete="off"
        name="search"
        placeholder="Search Products..."
      />
    </div>
  </div>

  <div class="action">
    <button mat-flat-button color="accent" (click)="openAddProduct()">
      <i class="bi bi-plus"></i>
      Add New Product
    </button>
    <button mat-flat-button color="primary" (click)="openCreateOrder()">
      <i class="bi bi-bag-plus-fill"></i>
      Create Order
    </button>
  </div>
</div>

<div class="main-content">
  <div class="table-container">
    <table matSort (matSortChange)="sortData($event)">
      <thead>
        <th class="text-center" style="width: 3%">#</th>
        <th class="text-center">SKU</th>
        <th class="text-center">QR</th>
        <th mat-sort-header="name" style="width: 20%">Name</th>
        <th>Catalog</th>
        <th>Vendor</th>
        <th>Sale Price</th>
        <th>Actual Price</th>
        <th class="text-left">Margin</th>
        <th class="text-center">Stock</th>
        <th class="text-center">Active</th>
        <th class="text-center">Added</th>
        <th class="text-center">Updated</th>
        <th class="text-right">Action</th>
      </thead>

      <tbody>
        <tr *ngFor="let product of sortedProducts">
          <td class="text-center">
            <mat-checkbox></mat-checkbox>
          </td>
          <td class="text-center">KU4</td>
          <td class="text-center">KU4</td>
          <td class="bold">{{ product.name | truncate : 40 }}</td>
          <td>{{ product?.catalog?.name }}</td>
          <td>{{ product?.vendor?.name }}</td>
          <td>{{ product?.salePrice | currency : "₹" }}</td>
          <td>{{ product?.actualPrice | currency : "₹" }}</td>
          <td class="text-left bold">
            <span
              [ngClass]="
                product.salePrice - product.actualPrice > 0 ? 'green' : 'red'
              "
            >
              {{ product.salePrice - product.actualPrice | currency : "₹" }}
            </span>
            <i
              class="bi bi-arrow-up green"
              *ngIf="product.salePrice - product.actualPrice > 0"
            ></i>
            <i
              class="bi bi-arrow-down red"
              *ngIf="product.salePrice - product.actualPrice < 0"
            ></i>
          </td>
          <td class="bold text-center">4/{{ product.stock }}</td>
          <td class="text-center">
            <i class="bi bi-fire red" *ngIf="product.active"></i>
            <i class="bi bi-x-lg red" *ngIf="!product.active"></i>
          </td>
          <td class="text-center">{{ product.createdAt | date }}</td>
          <td class="text-center">{{ product.updatedAt | date }}</td>
          <td class="text-right">
            <button mat-icon-button>
              <i class="bi bi-three-dots-vertical"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <app-loader
      class="text-center my-3 d-block"
      [size]="34"
      [includeBackdrop]="false"
      *ngIf="loadingProduct"
    ></app-loader>
    <mat-paginator
      *ngIf="!loadingProduct"
      [length]="100"
      [pageSize]="10"
      [pageSizeOptions]="[5, 10, 25, 100]"
      aria-label="Select page"
    >
    </mat-paginator>
  </div>
</div>
